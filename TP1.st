Object subclass: #AlgoVid	instanceVariableNames: 'personas burbujas colegios'	classVariableNames: ''	package: 'TP1-Main'!!AlgoVid methodsFor: 'colegio' stamp: 'NicolasZulaica 5/15/2021 21:09'!nuevoColegio: nombre  	colegios at: nombre asUppercase put: Colegio new.! !!AlgoVid methodsFor: 'colegio' stamp: 'NicolasZulaica 5/15/2021 21:12'!agregarA: nombreBurbuja alColegio: nombreColegio 	( colegios at: nombreColegio asUppercase ) agregar: ( burbujas at: nombreBurbuja asUppercase ).! !!AlgoVid methodsFor: 'colegio' stamp: 'NicolasZulaica 5/15/2021 21:08'!clasesPresencialesEn: nombreColegio 	^(colegios at: nombreColegio asUppercase ) clasesPresenciales.! !!AlgoVid methodsFor: 'personas' stamp: 'NicolasZulaica 5/15/2021 21:09'!puedeCircular: nombre	^ (personas at: nombre asUppercase ifAbsent: [^nil] ) puedeCircular.! !!AlgoVid methodsFor: 'personas' stamp: 'NicolasZulaica 5/15/2021 21:09'!diagnosticoDe: persona 	^ (personas at: persona asUppercase) diagnostico.! !!AlgoVid methodsFor: 'personas-contacto' stamp: 'NicolasZulaica 5/15/2021 21:09'!contactoEstrechoEntre: nombre1 y: nombre2 	(personas at: nombre1 asUppercase) enConactoCon: (personas at: nombre2 asUppercase).! !!AlgoVid methodsFor: 'burbujas' stamp: 'NicolasZulaica 5/15/2021 21:08'!burbujaPinchada: nombreBurbuja  	^(burbujas at: nombreBurbuja asUppercase) estaPinchada.! !!AlgoVid methodsFor: 'burbujas' stamp: 'NicolasZulaica 5/15/2021 21:09'!nuevaBurbuja: nombre 	burbujas at: nombre asUppercase put: Burbuja new.! !!AlgoVid methodsFor: 'burbujas' stamp: 'NicolasZulaica 5/15/2021 21:12'!agregarA: nombrePersona aLaBurbuja: nombreBurbuja 	( burbujas at: nombreBurbuja asUppercase ) agregar: ( personas at: nombrePersona  asUppercase ).! !!AlgoVid methodsFor: 'personas-condiciones' stamp: 'NicolasZulaica 5/15/2021 21:09'!esPersonalEsencial: nombre 	(personas at: nombre asUppercase) esPersonalEsencial.! !!AlgoVid methodsFor: 'personas-condiciones' stamp: 'NicolasZulaica 5/15/2021 21:08'!agregarSintoma: sintoma a: nombrePersona 	^(personas at: nombrePersona asUppercase ifAbsent: [^nil] ) agregarSintoma: sintoma.! !!AlgoVid methodsFor: 'personas-condiciones' stamp: 'NicolasZulaica 5/15/2021 21:09'!nuevaPersona: nombre	personas at:nombre asUppercase put: Persona new.! !!AlgoVid methodsFor: 'personas-condiciones' stamp: 'NicolasZulaica 5/15/2021 21:09'!esPersonaDeRiesgo: nombre 	(personas at: nombre asUppercase) esPersonaDeRiesgo.! !!AlgoVid methodsFor: 'personas-condiciones' stamp: 'NicolasZulaica 5/15/2021 21:09'!estaVacunadx: nombre	(personas at: nombre asUppercase ifAbsent: [^nil] ) estaVacunadx.! !!AlgoVid methodsFor: 'initialization' stamp: 'NicolasZulaica 5/14/2021 16:32'!initialize	personas := Dictionary new.	burbujas := Dictionary new.	colegios := Dictionary new.! !Object subclass: #Burbuja	instanceVariableNames: 'personas estado'	classVariableNames: ''	package: 'TP1-Main'!!Burbuja methodsFor: 'initialization' stamp: 'NicolasZulaica 5/13/2021 21:54'!initialize	personas := Set new.	estado := EstadoNoPinchada new.! !!Burbuja methodsFor: 'modificarEstado' stamp: 'NicolasZulaica 5/13/2021 22:44'!pincharBurbuja	estado := EstadoPinchada new.	personas do: [ :persona | persona enBurbujaPinchada ].! !!Burbuja methodsFor: 'acceso' stamp: 'NicolasZulaica 5/14/2021 15:23'!agregar: persona 	personas add: persona.	persona agregarBurbuja: self.	estado efectoDe: self alAgregar: persona.! !!Burbuja methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 21:54'!estaPinchada	^estado estaPinchada.! !Object subclass: #Colegio	instanceVariableNames: 'burbujas'	classVariableNames: ''	package: 'TP1-Main'!!Colegio methodsFor: 'initialization' stamp: 'NicolasZulaica 5/14/2021 15:55'!initialize 	burbujas := Set new.! !!Colegio methodsFor: 'acceso' stamp: 'NicolasZulaica 5/14/2021 16:30'!clasesPresenciales	burbujas ifEmpty: [ ^true ].	^ ( ( burbujas count: [ :burbuja | burbuja estaPinchada ] ) / burbujas size ) < ( 40/100 ).! !!Colegio methodsFor: 'acceso' stamp: 'NicolasZulaica 5/14/2021 15:57'!agregar: burbuja 	burbujas add: burbuja.! !Object subclass: #Persona	instanceVariableNames: 'condiciones diagnostico burbujas'	classVariableNames: ''	package: 'TP1-Main'!!Persona methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 23:22'!diagnostico	^(condiciones at: 'covid') diagnostico.! !!Persona methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 20:10'!puedeCircular	^ (condiciones inject: DefectoCircular new into:[ :acumulado :condicion | acumulado y: (condicion permisoCircular )  ]) puedeCircular.! !!Persona methodsFor: 'grupos' stamp: 'NicolasZulaica 5/14/2021 15:23'!agregarBurbuja: grupo	burbujas add: grupo.! !!Persona methodsFor: 'grupos' stamp: 'NicolasZulaica 5/13/2021 23:16'!pinchaBurbuja: burbuja	(condiciones at: 'covid') pinchaBurbuja: burbuja.! !!Persona methodsFor: 'modificarCondicion' stamp: 'NicolasZulaica 5/13/2021 19:36'!enConactoCon: otraPersona 	self contactar: otraPersona.	otraPersona contactar: self. ! !!Persona methodsFor: 'modificarCondicion' stamp: 'NicolasZulaica 5/15/2021 20:12'!agregarSintoma: sintoma 	diagnostico agregarSintoma: sintoma.	self actualizarCovid: (diagnostico condicion).! !!Persona methodsFor: 'private' stamp: 'NicolasZulaica 5/14/2021 18:41'!contactar: otraPersona	condiciones at:'contacto' put:		(otraPersona estadoAlContactar y: (condiciones at: 'contacto') ). ! !!Persona methodsFor: 'private' stamp: 'NicolasZulaica 5/13/2021 22:26'!actualizarCovid: condicion	condiciones at: 'covid' put: condicion.	condicion impactaA: self.! !!Persona methodsFor: 'private' stamp: 'NicolasZulaica 5/13/2021 20:10'!estadoAlContactar	^(condiciones at: 'covid') estadoAlContactar.! !!Persona methodsFor: 'agregarCondicion' stamp: 'NicolasZulaica 5/13/2021 22:46'!enBurbujaPinchada	condiciones at: 'burbuja' put: EnBurbujaPinchada new.! !!Persona methodsFor: 'agregarCondicion' stamp: 'NicolasZulaica 5/13/2021 20:17'!esPersonaDeRiesgo	condiciones at: 'riesgo' put: PersonalDeRiesgo new.! !!Persona methodsFor: 'agregarCondicion' stamp: 'NicolasZulaica 5/11/2021 23:49'!esPersonalEsencial	condiciones at:'escencial' put: PersonalEscencial new.! !!Persona methodsFor: 'agregarCondicion' stamp: 'NicolasZulaica 5/14/2021 15:23'!estaComprometida	burbujas do: [ :grupo | grupo pincharBurbuja ].! !!Persona methodsFor: 'agregarCondicion' stamp: 'NicolasZulaica 5/13/2021 20:10'!estaVacunadx	condiciones at: 'vacunado' put: Vacunado new.! !!Persona methodsFor: 'initialization' stamp: 'NicolasZulaica 5/15/2021 20:11'!initialize	condiciones := Dictionary new.	diagnostico := Diagnostico new.	burbujas := Set new.		condiciones at: 'vacunado' put: NoVacunado new.	condiciones at: 'contacto' put: ContactoEstrechoNegativo new.	self actualizarCovid: CovidNegativo new.! !Object subclass: #Diagnostico	instanceVariableNames: 'sintomas'	classVariableNames: ''	package: 'TP1-Diagnostico'!!Diagnostico methodsFor: 'initialization' stamp: 'NicolasZulaica 5/15/2021 18:47'!initialize 	sintomas := Set new.! !!Diagnostico methodsFor: 'acceso' stamp: 'NicolasZulaica 5/15/2021 19:35'!condicion	sintomas ifEmpty: [ ^CovidNegativo new ].	( sintomas size > 3 )ifTrue: [ ^CovidPositivo new ].	( (sintomas size = 3) & (sintomas anySatisfy: [ :sintoma | sintoma esComun ] )  )ifTrue: [ ^CovidPositivo new ].	^SospechosoCovid new.! !!Diagnostico methodsFor: 'acceso' stamp: 'NicolasZulaica 5/15/2021 20:10'!agregarSintoma: nombreSintoma 	(sintomas anySatisfy: [ :sintoma | sintoma es: nombreSintoma  ])ifTrue: [^self].	sintomas add: (Sintoma nuevo: nombreSintoma).! !Object subclass: #Sintoma	instanceVariableNames: 'nombre'	classVariableNames: ''	package: 'TP1-Diagnostico'!!Sintoma methodsFor: 'private' stamp: 'NicolasZulaica 5/15/2021 19:54'!nombre: nuevoNombre	nombre := nuevoNombre.! !!Sintoma methodsFor: 'acceso' stamp: 'NicolasZulaica 5/15/2021 19:02'!esComun	^false.! !!Sintoma methodsFor: 'acceso' stamp: 'NicolasZulaica 5/15/2021 19:49'!es: nombreSintoma  	^nombre sameAs: nombreSintoma.! !"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!Sintoma class	instanceVariableNames: ''!!Sintoma class methodsFor: 'constants' stamp: 'NicolasZulaica 5/15/2021 19:04'!sintomasComunes	^#( 'Tos' 'Fiebre' 'Cansancio' )! !!Sintoma class methodsFor: 'initialization' stamp: 'NicolasZulaica 5/15/2021 20:01'!nuevo: nombreSintoma	( self sintomasComunes includes: nombreSintoma  )ifTrue: [^SintomaComun new nombre: nombreSintoma ].	^SintomaSinClasificar new nombre: nombreSintoma.! !Sintoma subclass: #SintomaComun	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Diagnostico'!!SintomaComun methodsFor: 'accessing - bad' stamp: 'NicolasZulaica 5/15/2021 19:03'!esComun 	^true.! !Sintoma subclass: #SintomaSinClasificar	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Diagnostico'!!SintomaSinClasificar methodsFor: 'accessing - bad' stamp: 'NicolasZulaica 5/15/2021 19:03'!esComun 	^false.! !Object subclass: #EstadoNoPinchada	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-EstadosBurbuja'!!EstadoNoPinchada methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 21:51'!estaPinchada	^false.! !!EstadoNoPinchada methodsFor: 'operaciones' stamp: 'NicolasZulaica 5/13/2021 23:13'!efectoDe: burbuja alAgregar: persona.	persona pinchaBurbuja: burbuja.! !Object subclass: #EstadoPinchada	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-EstadosBurbuja'!!EstadoPinchada methodsFor: 'operaciones' stamp: 'NicolasZulaica 5/13/2021 22:54'!efectoDe: burbuja alAgregar: persona.	persona enBurbujaPinchada.! !!EstadoPinchada methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 21:52'!estaPinchada	^true! !Object subclass: #DefectoCircular	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Permisos'!!DefectoCircular methodsFor: 'acceso' stamp: 'NicolasZulaica 5/10/2021 21:50'!puedeCircular 	^false.! !!DefectoCircular methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 17:29'!yPuedeCircular 	^PuedeCircular new.! !!DefectoCircular methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/11/2021 20:32'!y: otroPermiso  	^ otroPermiso.! !Object subclass: #NoPuedeCircular	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Permisos'!!NoPuedeCircular methodsFor: 'acceso' stamp: 'NicolasZulaica 5/10/2021 20:45'!puedeCircular	^false.! !!NoPuedeCircular methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 17:28'!yPuedeCircular 	^self.! !!NoPuedeCircular methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/11/2021 20:32'!y: otroPermiso  	^self.! !Object subclass: #PuedeCircular	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Permisos'!!PuedeCircular methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 17:28'!yPuedeCircular	^self.! !!PuedeCircular methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 17:28'!y: otroPermiso	^otroPermiso yPuedeCircular.! !!PuedeCircular methodsFor: 'acceso' stamp: 'NicolasZulaica 5/10/2021 18:47'!puedeCircular	^true.! !Object subclass: #Condicion	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!Condicion methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 20:47'!permisoCircular	^DefectoCircular new.! !Condicion subclass: #ContactoEstrechoNegativo	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!ContactoEstrechoNegativo methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 18:35'!y: otroContacto 	^otroContacto.! !!ContactoEstrechoNegativo methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 18:35'!ySospechoso	^ContactoEstrechoSospechoso new.! !Condicion subclass: #ContactoEstrechoPositivo	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!ContactoEstrechoPositivo methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 21:22'!permisoCircular 	^NoPuedeCircular new.! !!ContactoEstrechoPositivo methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 18:59'!ySospechoso	^self.! !!ContactoEstrechoPositivo methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 18:59'!y: otroContacto	^self.! !Condicion subclass: #ContactoEstrechoSospechoso	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!ContactoEstrechoSospechoso methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 21:22'!permisoCircular 	^NoPuedeCircular new.! !!ContactoEstrechoSospechoso methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 18:33'!y: otroContacto	^otroContacto ySospechoso.! !!ContactoEstrechoSospechoso methodsFor: 'operadores-logicos' stamp: 'NicolasZulaica 5/14/2021 18:59'!ySospechoso	^self.! !Condicion subclass: #CovidNegativo	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!CovidNegativo methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 20:12'!diagnostico 	^'Negativo'.! !!CovidNegativo methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 20:12'!estadoAlContactar	^ContactoEstrechoNegativo new.! !!CovidNegativo methodsFor: 'operaciones' stamp: 'NicolasZulaica 5/13/2021 22:27'!impactaA: persona	^nil.! !!CovidNegativo methodsFor: 'grupos' stamp: 'NicolasZulaica 5/13/2021 23:18'!pinchaBurbuja: burbuja	^nil.! !Condicion subclass: #CovidPositivo	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!CovidPositivo methodsFor: 'operaciones' stamp: 'NicolasZulaica 5/13/2021 22:28'!impactaA: persona 	persona estaComprometida.! !!CovidPositivo methodsFor: 'grupos' stamp: 'NicolasZulaica 5/13/2021 23:17'!pinchaBurbuja: burbuja 	burbuja pincharBurbuja.! !!CovidPositivo methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 20:12'!diagnostico 	^'Positivo'.! !!CovidPositivo methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 21:22'!permisoCircular 	^NoPuedeCircular new.! !!CovidPositivo methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 20:04'!estadoAlContactar	^ContactoEstrechoPositivo new.! !Condicion subclass: #EnBurbujaPinchada	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!EnBurbujaPinchada methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 22:42'!permisoCircular 	^NoPuedeCircular new.! !Condicion subclass: #NoVacunado	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!Condicion subclass: #PersonalDeRiesgo	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!PersonalDeRiesgo methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 21:22'!permisoCircular 	^NoPuedeCircular new.! !Condicion subclass: #PersonalEscencial	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!PersonalEscencial methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 21:22'!permisoCircular 	^PuedeCircular new.! !Condicion subclass: #SospechosoCovid	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!SospechosoCovid methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 20:12'!diagnostico 	^'Sospechoso'.! !!SospechosoCovid methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 20:52'!permisoCircular	^NoPuedeCircular new.! !!SospechosoCovid methodsFor: 'acceso' stamp: 'NicolasZulaica 5/13/2021 20:06'!estadoAlContactar	^ContactoEstrechoSospechoso new! !!SospechosoCovid methodsFor: 'operaciones' stamp: 'NicolasZulaica 5/13/2021 22:27'!impactaA: persona 	^nil.! !!SospechosoCovid methodsFor: 'grupos' stamp: 'NicolasZulaica 5/13/2021 23:19'!pinchaBurbuja: burbuja	^nil.! !Condicion subclass: #Vacunado	instanceVariableNames: ''	classVariableNames: ''	package: 'TP1-Condiciones'!!Vacunado methodsFor: 'acceso' stamp: 'NicolasZulaica 5/11/2021 20:52'!permisoCircular	^PuedeCircular new.! !